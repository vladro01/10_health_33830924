<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>LevelUp Health Quests – Dashboard</title>
    <link rel="stylesheet" href="/style.css" />
  </head>
  <body class="page">
    <!-- Top bar -->
    <header class="top-bar">
      <div class="top-bar-left">
        <div class="logo-dot"></div>
        <span class="app-name">LevelUp</span>
        <span class="app-subtitle">Health Quests</span>
      </div>

      <nav class="nav-links">
        <a href="/" class="nav-link nav-link-active">Dashboard</a>
        <a href="/quests" class="nav-link">Quests</a>
        <a href="/search" class="nav-link">Search</a>
        <a href="/weather" class="nav-link">Weather</a>
        <a href="/about" class="nav-link">About</a>
      </nav>

      <div class="user-area">
        <% 
          const loggedIn = (typeof isAuthenticated !== 'undefined' && isAuthenticated) ||
                           (typeof username !== 'undefined' && username);
        %>
        <% if (loggedIn) { %>
          <span class="user-greeting">
            Hi, <strong><%= typeof username !== 'undefined' ? username : 'user' %></strong>
          </span>
          <a href="/quests/me/logs" class="nav-link">My logs</a>
          <% if (typeof username !== 'undefined' && username === 'gold') { %>
            <a href="/users/audit" class="nav-link">Audit</a>
          <% } %>
          <a href="/users/logout" class="btn btn-ghost small">Logout</a>
        <% } else { %>
          <a href="/users/login" class="btn btn-primary small">Login</a>
        <% } %>
      </div>
    </header>

    <!-- Main layout (hero + sidebar) -->
    <main class="layout">
      <!-- Daily quest hero card -->
      <section class="card card-quest">
        <div class="card-quest-header">
          <div>
            <p class="eyebrow">Daily quest</p>
            <h1 class="quest-title">
              <%= (typeof dailyQuest !== 'undefined' && dailyQuest && dailyQuest.name)
                    ? dailyQuest.name
                    : "Today’s quest" %>
            </h1>
            <p class="quest-subtitle">
              <% if (typeof dailyQuest !== 'undefined' && dailyQuest && dailyQuest.description) { %>
                <%= dailyQuest.description %>
              <% } else { %>
                Complete today’s featured routine to level up your training.
              <% } %>
            </p>
          </div>

          <div class="quest-meta">
            <% if (typeof dailyQuest !== 'undefined' && dailyQuest && dailyQuest.difficulty) { %>
              <span class="pill"><%= dailyQuest.difficulty %></span>
            <% } %>
            <% if (typeof dailyQuest !== 'undefined' && dailyQuest && dailyQuest.target_minutes) { %>
              <span class="pill pill-yellow">
                <%= dailyQuest.target_minutes %> min
              </span>
            <% } %>
          </div>
        </div>

        <div class="card-quest-body">
          <!-- Progress / CTA section -->
          <div class="quest-progress">
            <div class="progress-ring">
              <div class="progress-ring-inner">
                <div class="progress-number">0%</div>
                <div class="progress-label">Today</div>
              </div>
            </div>
            <p class="progress-text">
              Complete all exercises and log your quest to reach 100% for today.
            </p>

            <% if (typeof dailyQuest !== 'undefined' && dailyQuest && dailyQuest.id) { %>
              <a href="/quests/<%= dailyQuest.id %>" class="btn btn-primary large">
                Start quest
              </a>
            <% } else { %>
              <a href="/quests" class="btn btn-primary large">
                Browse all quests
              </a>
            <% } %>
          </div>

          <!-- Stats side -->
          <div class="quest-exercises">
            <p class="section-label">Your journey</p>
            <ul class="stats-list">
              <li class="stat-item">
                <span class="stat-label">Quests available</span>
                <span class="stat-value"><%= typeof questsAvailable !== 'undefined' ? questsAvailable : 0 %></span>
              </li>
              <li class="stat-item">
                <span class="stat-label">Core-focused quests</span>
                <span class="stat-value"><%= typeof coreQuests !== 'undefined' ? coreQuests : 0 %></span>
              </li>
              <li class="stat-item">
                <span class="stat-label">Outdoor quests</span>
                <span class="stat-value"><%= typeof outdoorQuests !== 'undefined' ? outdoorQuests : 0 %></span>
              </li>
            </ul>
            <p class="card-text small">
              View <a href="/quests">all quests</a> or
              <a href="/quests/me/logs">your logs</a> to see how you’re progressing.
            </p>
          </div>
        </div>

        <footer class="card-quest-footer">
          <p class="hint">
            Tip: use the weather module to check if conditions are good for outdoor quests.
          </p>
        </footer>
      </section>

      <!-- Right-hand sidebar cards -->
      <aside class="sidebar">
        <div class="card card-weather">
          <p class="eyebrow">Heading outside?</p>
          <h2 class="card-title">Check the weather</h2>
          <p class="card-text">
            Planning a jog? Use the weather checker to see if conditions are good
            for the Medium Jogging Quest.
          </p>
          <a href="/weather" class="btn btn-outline full-width">
            Open weather module
          </a>
        </div>

        <div class="card card-stats">
          <p class="eyebrow">Quick links</p>
          <p class="card-text">
            Ready to train? Jump straight into the quest library or review your
            previous logs.
          </p>
          <div class="stack-vertical">
            <a href="/quests" class="btn btn-ghost full-width">
              Browse quests
            </a>
            <a href="/quests/me/logs" class="btn btn-ghost full-width">
              View my logs
            </a>
          </div>
        </div>
      </aside>
    </main>
  </body>
</html>