<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Weather â€“ LevelUp</title>
    <link rel="stylesheet" href="/style.css">
  </head>
  <body class="page">
    <header class="top-bar">
      <div class="top-bar-left">
        <div class="logo-dot"></div>
        <span class="app-name">LevelUp</span>
        <span class="app-subtitle">Health Quests</span>
      </div>

      <nav class="nav-links">
        <a href="/" class="nav-link">Dashboard</a>
        <a href="/quests" class="nav-link">Quests</a>
        <a href="/search" class="nav-link">Search</a>
        <a href="/weather" class="nav-link nav-link-active">Weather</a>
        <a href="/about" class="nav-link">About</a>
      </nav>

      <div class="user-area">
        <% if (isAuthenticated) { %>
          <span class="user-greeting">Welcome, <strong><%= username %></strong></span>
          <a href="/quests/me/logs" class="btn btn-ghost small">My logs</a>
          <% if (username === 'gold') { %>
            <a href="/users/audit" class="btn btn-ghost small">Audit</a>
          <% } %>
          <a href="/users/logout" class="btn btn-outline small">Logout</a>
        <% } else { %>
          <a href="/users/login" class="btn btn-primary small">Login</a>
        <% } %>
      </div>
    </header>

    <main class="content-narrow">
      <section class="card-page">
        <p class="eyebrow">Heading outside?</p>
        <h1 class="page-title">Check the weather</h1>
        <p class="page-subtitle">
          Planning a jog? Use the weather checker to see if conditions are good
          for the <strong>Medium Jogging Quest</strong>.
        </p>

        <form action="/weather" method="POST" class="stack-vertical">
          <div class="form-row">
            <label>City</label>
            <input type="text" id="city" name="city" value="<%= city || '' %>" required>
          </div>
          <button type="submit" class="btn btn-primary">Get weather</button>
        </form>

        <% if (error) { %>
          <div class="error-banner" style="margin-top: 14px;"><%= error %></div>
        <% } %>

        <% if (weatherMessage) { %>
          <div style="margin-top: 18px;">
            <h2 class="card-title">Current conditions for <%= city %></h2>
            <p class="card-text"><%= weatherMessage %></p>

            <% if (conditionMain) { %>
              <p class="card-text small">
                Conditions:
                <strong><%= conditionMain %></strong>
                <% if (conditionDescription) { %>
                  (<%= conditionDescription %>)
                <% } %>
              </p>
            <% } %>

            <% if (joggingRecommendation) { %>
              <h3 class="card-title" style="margin-top: 10px;">Running recommendation</h3>
              <p class="card-text"><%= joggingRecommendation %></p>
            <% } %>

            <% if (joggingQuest) { %>
              <a href="/quests/<%= joggingQuest.id %>" class="btn btn-outline full-width" style="margin-top: 6px;">
                View "<%= joggingQuest.name %>" quest
              </a>
            <% } %>
          </div>
        <% } %>
      </section>
    </main>
  </body>
</html>